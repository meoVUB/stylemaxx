{% extends "base.html" %}
{% load static %}
{% block content %}
  <h1 class="text-2xl font-semibold mb-2">Swipe (DEV)</h1>
  <p class="text-slate-400 mb-4 text-sm">
    Developer sandbox for the Swipe logic.
    Outfit {{ index|add:1 }} of {{ total }}.
  </p>

  {% if done %}
    <div class="max-w-md mx-auto text-center space-y-4">
      <p class="text-lg font-semibold text-emerald-400">You're done swiping for now üéâ</p>
      <p class="text-slate-400 text-sm">
        Below is a preview of your learned style preferences (top keywords).
      </p>

      <div class="mt-4 border border-slate-800 rounded-xl p-4 text-left">
        <h2 class="text-sm font-semibold text-slate-200 mb-2">Top keywords</h2>
        {% if top_keywords %}
          <div class="flex flex-wrap gap-2">
            {% for kw, count in top_keywords %}
              <span class="inline-flex items-center px-2 py-0.5 rounded-full bg-slate-900 border border-slate-700 text-xs">
                {{ kw }} <span class="ml-1 text-slate-500">√ó{{ count }}</span>
              </span>
            {% endfor %}
          </div>
        {% else %}
          <p class="text-slate-500 text-sm">No preferences learned yet.</p>
        {% endif %}
      </div>

      <form method="post" action="{% url 'swipe_dev' %}">
        {% csrf_token %}
        <!-- reset swipe session by going back to index 0 is a later enhancement -->
        <button
          type="submit"
          name="action"
          value="reset"
          class="mt-4 px-4 py-2 rounded-lg bg-slate-800 border border-slate-600 text-sm hover:bg-slate-700"
          disabled
        >
          Reset (TODO)
        </button>
      </form>
    </div>

  {% else %}

    {% if outfit %}
      <div class="max-w-md mx-auto">
        <div class="bg-slate-900 rounded-2xl shadow-xl overflow-hidden border border-slate-800">
          <div class="aspect-[3/4] bg-slate-800 flex items-center justify-center">
            <img
              src="{% static outfit.static_path %}"
              alt="{{ outfit.id }}"
              class="w-full h-full object-cover"
            />
          </div>
          <div class="p-4 space-y-2">
            <h2 class="text-lg font-semibold">{{ outfit.id }}</h2>
            <p class="text-xs uppercase tracking-wide text-slate-400">Keywords</p>
            <p class="text-sm text-slate-300">
              {% for kw in outfit.keywords %}
                <span class="inline-flex items-center px-2 py-0.5 rounded-full bg-slate-800 text-xs mr-1 mb-1">
                  {{ kw }}
                </span>
              {% endfor %}
            </p>
          </div>
        </div>

        <!-- Like / Dislike forms -->
        <div class="mt-6 flex justify-center gap-6">
          <form method="post" action="{% url 'swipe_dev' %}">
            {% csrf_token %}
            <input type="hidden" name="action" value="dislike">
            <button
              type="submit"
              class="h-12 w-12 rounded-full bg-slate-900 border border-red-500/40 flex items-center justify-center text-red-400 text-xl hover:bg-red-500/10"
            >
              ‚úï
            </button>
          </form>

          <form method="post" action="{% url 'swipe_dev' %}">
            {% csrf_token %}
            <input type="hidden" name="action" value="like">
            <button
              type="submit"
              class="h-14 w-14 rounded-full bg-emerald-500 text-slate-950 text-2xl shadow-lg shadow-emerald-500/30 hover:bg-emerald-400"
            >
              ‚ù§
            </button>
          </form>
        </div>
      </div>
    {% else %}
      <p class="text-slate-400">No outfit available.</p>
    {% endif %}

  {% endif %}
{% endblock %}
