{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="text-center mb-6">
  <h1 class="text-2xl font-semibold mb-2 text-[#272323]">Outfits</h1>
</div>

<p class="text-[#5B3E3E] text-sm text-center mb-6">
  Your AI-generated outfits.
</p>
  {% if tops_count is not None %}
    <p class="text-xs text-[#5B3E3E] mb-2 text-center">
      Debug: {{ tops_count }} tops ({{ tops_ids|join:", " }}),
      {{ bottoms_count }} bottoms ({{ bottoms_ids|join:", " }}).
    </p>
  {% endif %}

  {% if not has_preferences %}
    <p class="text-[#5B3E3E] text-sm mb-4 text-center">
      We don't know your style yet. Swipe a few outfits first, then come back here.
    </p>
  {% endif %}

  {% if error %}
    <p class="text-red-400 text-xs mb-4 text-center">
      {{ error }}
    </p>
  {% endif %}

  <div class="grid gap-y-6 gap-x-12 md:grid-cols-2 max-w-6xl mx-auto">
    <!-- Left: StyleMaxx Model image -->
<!-- Left: StyleMaxx Model with bottom label in same div -->
<div class="rounded-xl overflow-hidden bg-[#C29D9D] flex flex-col items-center border border-[#A88D8D] shadow-lg">
  {% if model_image_url %}
    <img
      src="{{ model_image_url }}"
      alt="Your style model"
      class="object-contain w-full max-h-[480px] bg-white"
    />
    <div class="w-full text-center py-3">
      <span class="text-sm text-[#2E1E1E] font-medium">Your Stylemaxx model</span>
    </div>
  {% else %}
    <div class="w-full py-6 px-4 text-center">
      <p class="text-[#5B3E3E] text-sm">
        No model yet.
        <a href="{% url 'onboarding' %}" class="text-[#2E1E1E] underline font-medium">
          Create one here
        </a>.
      </p>
    </div>
  {% endif %}
</div>

    <!-- Right: outfit details -->
    <div class="flex flex-col gap-4">
      {% if outfit and outfit.items %}
        <div>
          <h2 class="text-lg font-semibold text-[#2E1E1E] mb-1">
            {{ outfit.name|default:"Your outfit" }}
          </h2>
          {% if outfit.style_notes %}
            <p class="text-[#5B3E3E] text-sm mb-3">
              {{ outfit.style_notes }}
            </p>
          {% endif %}
        </div>

        <div class="space-y-3">
          {% for item in outfit.items %}
            <div class="flex gap-3 border border-[#A88D8D] rounded-xl overflow-hidden bg-[#C29D9D]">
              <div class="w-24 bg-[#B89F9F] shrink-0">
                <img
                  src="{% static item.static_path %}"
                  alt="{{ item.name }}"
                  class="w-full h-full object-cover"
                />
              </div>
              <div class="p-3 flex flex-col justify-between text-sm text-[#2E1E1E] w-full">
                <div>
                  <p class="font-semibold">{{ item.name }}</p>
                  <p class="text-xs text-[#5B3E3E]">{{ item.shop }}</p>
                </div>
                <div class="flex items-center justify-between mt-2">
                  <span class="text-sm font-semibold text-[#2E1E1E]">
                    {{ item.price }} {{ item.currency }}
                  </span>
                  <a
                    href="{{ item.url }}"
                    target="_blank"
                    class="text-xs px-3 py-0.5 rounded-full bg-[#E3BDBD] text-[#2E1E1E] font-medium shadow hover:bg-[#dcb1b1]"
                  >
                    View item
                  </a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>

        <div class="mt-4 border-t border-[#A88D8D] pt-3 flex items-center justify-between text-sm text-[#2E1E1E]">
          <span class="text-[#5B3E3E]">Total outfit price</span>
          <span class="font-semibold">
            {{ outfit.total_price|floatformat:2 }} {{ outfit.currency }}
          </span>
        </div>

      {% else %}
        <p class="text-[#5B3E3E] text-sm text-center">
          No outfit generated yet. Make sure you've swiped some outfits in the
          <a href="{% url 'swipe' %}" class="text-[#2E1E1E] underline font-medium">Swipe</a> tab.
        </p>
      {% endif %}
    </div>
  </div>
{% endblock %}
